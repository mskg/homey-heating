/*! For license information please see 25.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[25],{"./components/TemperatureChart/index.tsx":(t,e,s)=>{s.r(e),s.d(e,{calculateDay:()=>n.u,default:()=>p});var a=s("../../node_modules/@material-ui/core/esm/styles/withStyles.js"),i=s("../../node_modules/lodash/lodash.js"),r=s("../../node_modules/react/index.js"),h=s("../app/model/index.ts"),n=s("./state/calculateDay.tsx"),d=s("./i18n/Translation.tsx"),l=s("./components/temperatureToColor.tsx"),o=s("../../node_modules/d3/index.js");const c=new Date(1979,1,29,0,0,0,0),u=new Date(1979,1,30,0,0,0,0);class m{constructor(t,e=!0,s,a){this.rootElement=t,this.showLegend=e,this.tickFormat="%H:%M",this.margin={top:0,right:16,bottom:16,left:28},this.series=[],this.minTime=c,this.maxTime=u,this.showLegend||(this.margin={top:0,right:0,bottom:0,left:0}),this.height=(a||t.clientHeight)-this.margin.top-this.margin.bottom,this.width=(s||t.clientWidth)-32-this.margin.right-this.margin.left,this.series=[(0,d.Z)("schedule.Monday"),(0,d.Z)("schedule.Tuesday"),(0,d.Z)("schedule.Wednesday"),(0,d.Z)("schedule.Thursday"),(0,d.Z)("schedule.Friday"),(0,d.Z)("schedule.Saturday"),(0,d.Z)("schedule.Sunday")],this.initAxis(),this.createChart(!0)}data(t){const e=this.createChart(!1).select(".chart").selectAll("g").data(t,(t=>t.start+t.taskName+t.end)),s=e.enter().insert("g").attr("fill",(t=>t.color)).attr("transform",(t=>"translate("+this.xScale(t.start)+","+this.yScale(t.taskName)+")"));if(s.insert("rect").attr("height",this.yScale.bandwidth).attr("width",(t=>Math.max(1,(this.xScale(t.end)||0)-(this.xScale(t.start)||0)))),this.showLegend){const t=s.insert("text").attr("text-anchor","start").attr("x",6).attr("y",20).attr("width",(t=>Math.max(1,(this.xScale(t.end)||0)-(this.xScale(t.start)||0)-6))).text((t=>this.fixedDigits(t.temperature,1)));this.dotme(t)}e.exit().remove()}initAxis(){this.xScale=o.Xf().domain([this.minTime,this.maxTime]).range([0,this.width]).clamp(!0),this.yScale=o.tiA().domain(this.series).rangeRound([0,this.height-this.margin.top-this.margin.bottom]).padding(this.showLegend?.1:0),this.xAxis=o.LLu(this.xScale).tickFormat(o.i$Z(this.tickFormat)).tickSize(this.showLegend?8:0).tickPadding(this.showLegend?8:0),this.yAxis=o.y4O(this.yScale).tickPadding(this.showLegend?8:0).tickSize(0)}dotme(t){t.each((function(){const t=o.Ys(this),e=parseInt(t.attr("width"),10);6.75*t.text().length>e&&t.text("")}))}fixedDigits(t,e){return(Math.round(t*Math.pow(10,e))/Math.pow(10,e)).toFixed(e)}createChart(t){let e=o.Ys(this.rootElement).select("svg");return t&&e.remove(),e.empty()&&(e=o.Ys(this.rootElement).append("svg").attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom),e.append("g").attr("class","chart").attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom).attr("transform","translate("+this.margin.left+", "+this.margin.top+")"),this.showLegend&&(e.append("g").attr("class","x axis").attr("transform","translate("+this.margin.left+", "+(this.height-this.margin.top-this.margin.bottom)+")").call(this.xAxis),e.append("g").attr("class","y axis").attr("transform","translate("+this.margin.left+", 0)").call(this.yAxis))),e}}class g{static fullDay(t,e){return new g({hour:0,minute:0,targetTemperature:e,index:-1,day:t})}static firstHalf(t,e){return new g({hour:0,minute:0,targetTemperature:t?t.targetTemperature:e.targetTemperature,index:-1,day:e.day},e)}constructor(t,e){this.start=new Date(c),this.end=new Date(c),this.temperature=t?t.targetTemperature:e?e.targetTemperature:0,this.start.setHours(t?t.hour:0,t?t.minute:0),this.end.setHours(e?e.hour:24,e?e.minute:0),this.taskName=(t=>{switch(t){case h.Jc.Sunday:return(0,d.Z)("schedule.Sunday");case h.Jc.Monday:return(0,d.Z)("schedule.Monday");case h.Jc.Tuesday:return(0,d.Z)("schedule.Tuesday");case h.Jc.Wednesday:return(0,d.Z)("schedule.Wednesday");case h.Jc.Thursday:return(0,d.Z)("schedule.Thursday");case h.Jc.Friday:return(0,d.Z)("schedule.Friday");case h.Jc.Saturday:return(0,d.Z)("schedule.Saturday");default:return"XX"}})(t?t.day:e?e.day:0),this.color=(0,l.h)(this.temperature)}}const p=(0,a.Z)((t=>({chart:{padding:t.spacing(2),width:"100%","& .axis domain":{fill:t.palette.text.primary},"& text":{fill:t.palette.text.primary,fontSize:"12px"}}})))((t=>{const{classes:e,plan:s,height:a,legend:d}=t,l=r.createRef(),[o,c]=(()=>{const[t,e]=r.useState(null),[s,a]=r.useState({width:t?t.clientWidth:0,height:t?t.clientHeight:0});function h(t){a({width:t?t.clientWidth:0,height:t?t.clientHeight:0})}return r.useEffect((()=>{if(null!=t){h(t);const s=(e=t,(0,i.debounce)((()=>{h(e)}),300));return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}}var e}),[t]),[e,s]})();return r.useEffect((()=>{if(null!=l.current){const t=new m(l.current,d,c.width,c.height),e=[];[h.Jc.Monday,h.Jc.Tuesday,h.Jc.Wednesday,h.Jc.Thursday,h.Jc.Friday,h.Jc.Saturday,h.Jc.Sunday].forEach((t=>{const{schedules:a,last:i}=(0,n.u)(Object.assign(Object.assign({},s),{schedule:(0,n.M)(s.schedule)}),t);if(0===a.length){if(null==i)return;return void e.push(g.fullDay(t,i.targetTemperature))}if(1===a.length&&null==i)return void e.push(g.fullDay(t,a[0].targetTemperature));let r=null;a.forEach((t=>{null==r?e.push(g.firstHalf(i,t)):e.push(new g(r,t)),r=t})),null!=r&&e.push(new g(r))})),t.data(e)}}),[s,c]),r.useEffect((()=>{o(l.current)}),[l]),r.createElement("div",{style:{height:a||300},className:e.chart,ref:l})}))},"./components/temperatureToColor.tsx":(t,e,s)=>{s.d(e,{h:()=>n});var a=s("../../node_modules/@material-ui/core/colors/amber.js"),i=s("../../node_modules/@material-ui/core/colors/blue.js"),r=s("../../node_modules/@material-ui/core/colors/deepOrange.js"),h=s("../../node_modules/@material-ui/core/colors/green.js");const n=t=>{const e=Math.round(100*(s=Math.min(Math.max(16,t),24),16,24,1,8,Math.floor(7*(s-16)/8+1))+100);var s;return t<=16?i.Z[e]:t<=18.5?h.Z[e]:t<=20.5?a.Z[e]:r.Z[e]}}}]);
//# sourceMappingURL=https://raw.githubusercontent.com/mskg/homey-heating/release/v2.0.0-rc11/settings/25.js.map