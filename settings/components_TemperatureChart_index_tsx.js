/*! For license information please see components_TemperatureChart_index_tsx.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["components_TemperatureChart_index_tsx"],{"./components/TemperatureChart/Component.tsx":(t,e,a)=>{a.r(e),a.d(e,{default:()=>d});var s=a("../../node_modules/@material-ui/core/esm/styles/withStyles.js"),r=a("../../node_modules/lodash/lodash.js"),i=a("../../node_modules/react/index.js"),n=a("../app/model/index.ts"),h=a("./state/calculateDay.tsx"),l=a("./components/TemperatureChart/SeriesElement.tsx"),o=a("./components/TemperatureChart/SVGGenerator.tsx");const d=(0,s.default)((t=>({chart:{padding:t.spacing(2),width:"100%","& .axis domain":{fill:t.palette.text.primary},"& text":{fill:t.palette.text.primary,fontSize:"12px"}}})))((t=>{const{classes:e,plan:a,height:s,legend:d}=t,u=i.createRef(),[c,m]=(()=>{const[t,e]=i.useState(null),[a,s]=i.useState({width:t?t.clientWidth:0,height:t?t.clientHeight:0});function n(t){s({width:t?t.clientWidth:0,height:t?t.clientHeight:0})}return i.useEffect((()=>{if(null!=t){n(t);const a=(e=t,(0,r.debounce)((()=>{n(e)}),300));return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}}var e}),[t]),[e,a]})();return i.useEffect((()=>{if(null!=u.current){const t=new o.SVGGenerator(u.current,d,m.width,m.height),e=[];[n.Day.Monday,n.Day.Tuesday,n.Day.Wednesday,n.Day.Thursday,n.Day.Friday,n.Day.Saturday,n.Day.Sunday].forEach((t=>{const{schedules:s,last:r}=(0,h.calculateDay)(Object.assign(Object.assign({},a),{schedule:(0,h.sortSchedules)(a.schedule)}),t);if(0===s.length){if(null==r)return;return void e.push(l.SeriesElement.fullDay(t,r.targetTemperature))}if(1===s.length&&null==r)return void e.push(l.SeriesElement.fullDay(t,s[0].targetTemperature));let i=null;s.forEach((t=>{null==i?e.push(l.SeriesElement.firstHalf(r,t)):e.push(new l.SeriesElement(i,t)),i=t})),null!=i&&e.push(new l.SeriesElement(i))})),t.data(e)}}),[a,m]),i.useEffect((()=>{c(u.current)}),[u]),i.createElement("div",{style:{height:s||300},className:e.chart,ref:u})}))},"./components/TemperatureChart/SVGGenerator.tsx":(t,e,a)=>{a.r(e),a.d(e,{MAX_DATE:()=>n,MIN_DATE:()=>i,SVGGenerator:()=>h});var s=a("../../node_modules/d3/index.js"),r=a("./i18n/Translation.tsx");const i=new Date(1979,1,29,0,0,0,0),n=new Date(1979,1,30,0,0,0,0);class h{constructor(t,e=!0,a,s){this.rootElement=t,this.showLegend=e,this.tickFormat="%H:%M",this.margin={top:0,right:16,bottom:16,left:28},this.series=[],this.minTime=i,this.maxTime=n,this.showLegend||(this.margin={top:0,right:0,bottom:0,left:0}),this.height=(s||t.clientHeight)-this.margin.top-this.margin.bottom,this.width=(a||t.clientWidth)-32-this.margin.right-this.margin.left,this.series=[(0,r.default)("schedule.Monday"),(0,r.default)("schedule.Tuesday"),(0,r.default)("schedule.Wednesday"),(0,r.default)("schedule.Thursday"),(0,r.default)("schedule.Friday"),(0,r.default)("schedule.Saturday"),(0,r.default)("schedule.Sunday")],this.initAxis(),this.createChart(!0)}data(t){const e=this.createChart(!1).select(".chart").selectAll("g").data(t,(t=>t.start+t.taskName+t.end)),a=e.enter().insert("g").attr("fill",(t=>t.color)).attr("transform",(t=>"translate("+this.xScale(t.start)+","+this.yScale(t.taskName)+")"));if(a.insert("rect").attr("height",this.yScale.bandwidth).attr("width",(t=>Math.max(1,(this.xScale(t.end)||0)-(this.xScale(t.start)||0)))),this.showLegend){const t=a.insert("text").attr("text-anchor","start").attr("x",6).attr("y",20).attr("width",(t=>Math.max(1,(this.xScale(t.end)||0)-(this.xScale(t.start)||0)-6))).text((t=>this.fixedDigits(t.temperature,1)));this.dotme(t)}e.exit().remove()}initAxis(){this.xScale=s.scaleTime().domain([this.minTime,this.maxTime]).range([0,this.width]).clamp(!0),this.yScale=s.scaleBand().domain(this.series).rangeRound([0,this.height-this.margin.top-this.margin.bottom]).padding(this.showLegend?.1:0),this.xAxis=s.axisBottom(this.xScale).tickFormat(s.timeFormat(this.tickFormat)).tickSize(this.showLegend?8:0).tickPadding(this.showLegend?8:0),this.yAxis=s.axisLeft(this.yScale).tickPadding(this.showLegend?8:0).tickSize(0)}dotme(t){t.each((function(){const t=s.select(this),e=parseInt(t.attr("width"),10);6.75*t.text().length>e&&t.text("")}))}fixedDigits(t,e){return(Math.round(t*Math.pow(10,e))/Math.pow(10,e)).toFixed(e)}createChart(t){let e=s.select(this.rootElement).select("svg");return t&&e.remove(),e.empty()&&(e=s.select(this.rootElement).append("svg").attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom),e.append("g").attr("class","chart").attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom).attr("transform","translate("+this.margin.left+", "+this.margin.top+")"),this.showLegend&&(e.append("g").attr("class","x axis").attr("transform","translate("+this.margin.left+", "+(this.height-this.margin.top-this.margin.bottom)+")").call(this.xAxis),e.append("g").attr("class","y axis").attr("transform","translate("+this.margin.left+", 0)").call(this.yAxis))),e}}},"./components/TemperatureChart/SeriesElement.tsx":(t,e,a)=>{a.r(e),a.d(e,{SeriesElement:()=>h});var s=a("../app/model/index.ts"),r=a("./i18n/Translation.tsx"),i=a("./components/temperatureToColor.tsx"),n=a("./components/TemperatureChart/SVGGenerator.tsx");class h{static fullDay(t,e){return new h({hour:0,minute:0,targetTemperature:e,index:-1,day:t})}static firstHalf(t,e){return new h({hour:0,minute:0,targetTemperature:t?t.targetTemperature:e.targetTemperature,index:-1,day:e.day},e)}constructor(t,e){this.start=new Date(n.MIN_DATE),this.end=new Date(n.MIN_DATE),this.temperature=t?t.targetTemperature:e?e.targetTemperature:0,this.start.setHours(t?t.hour:0,t?t.minute:0),this.end.setHours(e?e.hour:24,e?e.minute:0),this.taskName=(t=>{switch(t){case s.Day.Sunday:return(0,r.default)("schedule.Sunday");case s.Day.Monday:return(0,r.default)("schedule.Monday");case s.Day.Tuesday:return(0,r.default)("schedule.Tuesday");case s.Day.Wednesday:return(0,r.default)("schedule.Wednesday");case s.Day.Thursday:return(0,r.default)("schedule.Thursday");case s.Day.Friday:return(0,r.default)("schedule.Friday");case s.Day.Saturday:return(0,r.default)("schedule.Saturday");default:return"XX"}})(t?t.day:e?e.day:0),this.color=(0,i.temperatureToColor)(this.temperature)}}},"./components/TemperatureChart/index.tsx":(t,e,a)=>{a.r(e),a.d(e,{calculateDay:()=>r.calculateDay,default:()=>i});var s=a("./components/TemperatureChart/Component.tsx"),r=a("./state/calculateDay.tsx");const i=s.default},"./components/temperatureToColor.tsx":(t,e,a)=>{a.r(e),a.d(e,{slotTemperature:()=>h,temperatureToColor:()=>l});var s=a("../../node_modules/@material-ui/core/colors/amber.js"),r=a("../../node_modules/@material-ui/core/colors/blue.js"),i=a("../../node_modules/@material-ui/core/colors/deepOrange.js"),n=a("../../node_modules/@material-ui/core/colors/green.js");function h(t,e,a,s,r){return Math.floor((r-s)*(t-e)/(a-e)+s)}const l=t=>{const e=Math.round(100*h(Math.min(Math.max(16,t),24),16,24,1,8)+100);return t<=16?r.default[e]:t<=18.5?n.default[e]:t<=20.5?s.default[e]:i.default[e]}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50c19UZW1wZXJhdHVyZUNoYXJ0X2luZGV4X3RzeC5qcyIsIm1hcHBpbmdzIjoiO3FnQkFTQSxNQXFIQSxHQUFlLGNBbEYrQkEsSUFDbkMsQ0FDSEMsTUFBTyxDQUNIQyxRQUFTRixFQUFNRyxRQUFRLEdBQ3ZCQyxNQUFPLE9BRVAsaUJBQW9CLENBQ2hCQyxLQUFNTCxFQUFNTSxRQUFRQyxLQUFLQyxTQUc3QixTQUFZLENBQ1JILEtBQU1MLEVBQU1NLFFBQVFDLEtBQUtDLFFBQ3pCQyxTQUFVLFlBc0UxQixFQTFEMERDLElBQ3RELE1BQU0sUUFBRUMsRUFBTyxLQUFFQyxFQUFJLE9BQUVDLEVBQU0sT0FBRUMsR0FBV0osRUFDcENLLEVBQU0sZUFDTEMsRUFBUUMsR0E5REcsTUFDbEIsTUFBT0YsRUFBS0MsR0FBVSxXQUFzQyxPQUVyREMsRUFBWUMsR0FBaUIsV0FBZSxDQUMvQ2QsTUFBT1csRUFBTUEsRUFBSUksWUFBYyxFQUMvQk4sT0FBUUUsRUFBTUEsRUFBSUssYUFBZSxJQUdyQyxTQUFTQyxFQUFpQkMsR0FDdEJKLEVBQWMsQ0FDVmQsTUFBT2tCLEVBQVFBLEVBQU1ILFlBQWMsRUFDbkNOLE9BQVFTLEVBQVFBLEVBQU1GLGFBQWUsR0FFN0MsQ0FtQkEsT0FoQkEsYUFBZ0IsS0FDWixHQUFXLE1BQVBMLEVBQWEsQ0FDYk0sRUFBaUJOLEdBRWpCLE1BQU1RLEdBQVNDLEVBRU5ULEdBRm1CLElBQUFVLFdBQVMsS0FDakNKLEVBQWlCRyxFQUFTLEdBQzNCLE1BSUgsT0FGQUUsT0FBT0MsaUJBQWlCLFNBQVVKLEdBRTNCLEtBQ0hHLE9BQU9FLG9CQUFvQixTQUFVTCxFQUFLLEVBUGpDLElBQUVDLElBVXBCLENBQUNULElBRUcsQ0FBQ0MsRUFBUUMsRUFBVyxFQThCRVksR0FvRDdCLE9BbERBLGFBQWdCLEtBQ1osR0FBbUIsTUFBZmQsRUFBSWUsUUFBaUIsQ0FDckIsTUFBTTdCLEVBQVEsSUFBSSxFQUFBOEIsYUFBYWhCLEVBQUllLFFBQVNoQixFQUN2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LEVBQUFBLElBQUEsT0FBWSxPQUFPLGFBQVUsbUJBQ2xDLEtBQUssRUFBQUEsSUFBQSxTQUFjLE9BQU8sYUFBVSxxQkFDcEMsUUFBUyxNQUFPLE9BeUNBb0YsQ0FBYUgsRUFDbkJBLEVBQUsvRSxJQUNMZ0YsRUFBS0EsRUFBR2hGLElBQU0sR0FFeEIyQixLQUFLZ0IsT0FBUSxJQUFBd0Msb0JBQW1CeEQsS0FBS3VCLFlBQ3pDLDZNQzVESixRQUFlLEVBQVMsZ1hDSWpCLFNBQVNrQyxFQUFnQkMsRUFBYUMsRUFBYXRDLEVBQWF1QyxFQUFXQyxHQUs5RSxPQUFPekMsS0FBSzBDLE9BQ0xELEVBQUlELElBQU1GLEVBQU1DLElBQ2xCdEMsRUFBTXNDLEdBQ0xDLEVBRVYsQ0FFTyxNQUFNSixFQUFzQk8sSUFFL0IsTUFBTUMsRUFBUTVDLEtBQUtvQixNQUdQLElBSGFpQixFQUNyQnJDLEtBQUt1QyxJQUFJdkMsS0FBS0MsSUFBSSxHQUFJMEMsR0FBSSxJQUMxQixHQUFJLEdBQ0osRUFBRyxHQUFXLEtBRWxCLE9BQUlBLEdBQUssR0FDRSxVQUFLQyxHQUdaRCxHQUFLLEtBQ0UsVUFBTUMsR0FHYkQsR0FBSyxLQUNFLFVBQU1DLEdBR1YsVUFBV0EsRUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2NvbXBvbmVudHMvVGVtcGVyYXR1cmVDaGFydC9Db21wb25lbnQudHN4Iiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvVGVtcGVyYXR1cmVDaGFydC9TVkdHZW5lcmF0b3IudHN4Iiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvVGVtcGVyYXR1cmVDaGFydC9TZXJpZXNFbGVtZW50LnRzeCIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL1RlbXBlcmF0dXJlQ2hhcnQvaW5kZXgudHN4Iiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvdGVtcGVyYXR1cmVUb0NvbG9yLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdHlsZVJ1bGVzQ2FsbGJhY2ssIHdpdGhTdHlsZXMsIFdpdGhTdHlsZXMgfSBmcm9tIFwiQG1hdGVyaWFsLXVpL2NvcmUvc3R5bGVzXCI7XG5pbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gXCJsb2Rhc2hcIjtcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IERheSwgSUhlYXRpbmdQbGFuIH0gZnJvbSBcIi4uLy4uLy4uL2FwcC9tb2RlbFwiO1xuaW1wb3J0IHsgY2FsY3VsYXRlRGF5LCBzb3J0U2NoZWR1bGVzIH0gZnJvbSBcIi4uLy4uL3N0YXRlL2NhbGN1bGF0ZURheVwiO1xuaW1wb3J0IHsgSW5kZXhlZFNldFBvaW50IH0gZnJvbSBcIi4uLy4uL3N0YXRlL1BsYW5SZWR1Y2VyXCI7XG5pbXBvcnQgeyBTZXJpZXNFbGVtZW50IH0gZnJvbSBcIi4vU2VyaWVzRWxlbWVudFwiO1xuaW1wb3J0IHsgU1ZHR2VuZXJhdG9yIH0gZnJvbSBcIi4vU1ZHR2VuZXJhdG9yXCI7XG5cbmNvbnN0IHVzZURpbWVuc2lvbnMgPSAoKSA9PiB7XG4gICAgY29uc3QgW3JlZiwgc2V0UmVmXSA9IFJlYWN0LnVzZVN0YXRlPEhUTUxEaXZFbGVtZW50IHwgbnVsbD4obnVsbCk7XG5cbiAgICBjb25zdCBbZGltZW5zaW9ucywgc2V0RGltZW5zaW9uc10gPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICAgIHdpZHRoOiByZWYgPyByZWYuY2xpZW50V2lkdGggOiAwLFxuICAgICAgICBoZWlnaHQ6IHJlZiA/IHJlZi5jbGllbnRIZWlnaHQgOiAwLFxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gdXBkYXRlRGltZW5zaW9ucyhpbm5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgc2V0RGltZW5zaW9ucyh7XG4gICAgICAgICAgICB3aWR0aDogaW5uZXIgPyBpbm5lci5jbGllbnRXaWR0aCA6IDAsXG4gICAgICAgICAgICBoZWlnaHQ6IGlubmVyID8gaW5uZXIuY2xpZW50SGVpZ2h0IDogMCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChyZWYgIT0gbnVsbCkge1xuICAgICAgICAgICAgdXBkYXRlRGltZW5zaW9ucyhyZWYpO1xuXG4gICAgICAgICAgICBjb25zdCBmdW5jID0gKChzYXZlZFJlZikgPT4gZGVib3VuY2UoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZURpbWVuc2lvbnMoc2F2ZWRSZWYpO1xuICAgICAgICAgICAgfSwgMzAwKSkocmVmKTtcblxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuYyk7XG5cbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuYyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwgW3JlZl0pO1xuXG4gICAgcmV0dXJuIFtzZXRSZWYsIGRpbWVuc2lvbnNdO1xufTtcblxuY29uc3Qgc3R5bGVzOiBTdHlsZVJ1bGVzQ2FsbGJhY2s8YW55LCBhbnk+ID0gKHRoZW1lKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2hhcnQ6IHtcbiAgICAgICAgICAgIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG5cbiAgICAgICAgICAgIFtcIiYgLmF4aXMgZG9tYWluXCJdOiB7XG4gICAgICAgICAgICAgICAgZmlsbDogdGhlbWUucGFsZXR0ZS50ZXh0LnByaW1hcnksXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBbXCImIHRleHRcIl06IHtcbiAgICAgICAgICAgICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLnRleHQucHJpbWFyeSxcbiAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIxMnB4XCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59O1xuXG50eXBlIFByb3BzID0ge1xuICAgIHBsYW46IElIZWF0aW5nUGxhbixcbiAgICBoZWlnaHQ/OiBudW1iZXIsXG4gICAgbGVnZW5kPzogYm9vbGVhbixcbn0gJiBXaXRoU3R5bGVzPHR5cGVvZiBzdHlsZXM+O1xuXG5jb25zdCBUZW1wZXJhdHVyZUNoYXJ0OiBSZWFjdC5GdW5jdGlvbkNvbXBvbmVudDxQcm9wcz4gPSAocHJvcHMpID0+IHtcbiAgICBjb25zdCB7IGNsYXNzZXMsIHBsYW4sIGhlaWdodCwgbGVnZW5kIH0gPSBwcm9wcztcbiAgICBjb25zdCByZWYgPSBSZWFjdC5jcmVhdGVSZWY8SFRNTERpdkVsZW1lbnQ+KCk7XG4gICAgY29uc3QgW3NldFJlZiwgZGltZW5zaW9uc10gPSB1c2VEaW1lbnNpb25zKCk7XG5cbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocmVmLmN1cnJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgY2hhcnQgPSBuZXcgU1ZHR2VuZXJhdG9yKHJlZi5jdXJyZW50LCBsZWdlbmQsXG4gICAgICAgICAgICAgICAgKGRpbWVuc2lvbnMgYXMgYW55KS53aWR0aCxcbiAgICAgICAgICAgICAgICAoZGltZW5zaW9ucyBhcyBhbnkpLmhlaWdodCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHRhc2tzOiBTZXJpZXNFbGVtZW50W10gPSBbXTtcblxuICAgICAgICAgICAgLy8gc2V0cG9pbnRzIGdldCB0cmFuc2xhdGVkIHRvIFtmcm9tIC0gdG9dXG4gICAgICAgICAgICBbRGF5Lk1vbmRheSwgRGF5LlR1ZXNkYXksIERheS5XZWRuZXNkYXksIERheS5UaHVyc2RheSwgRGF5LkZyaWRheSwgRGF5LlNhdHVyZGF5LCBEYXkuU3VuZGF5XS5mb3JFYWNoKChkYXkpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBzY2hlZHVsZXMgbmVlZCB0byBiZSBzb3J0ZWRcbiAgICAgICAgICAgICAgICBjb25zdCB7IHNjaGVkdWxlcywgbGFzdCB9ID0gY2FsY3VsYXRlRGF5KHsgLi4ucGxhbiwgc2NoZWR1bGU6IHNvcnRTY2hlZHVsZXMocGxhbi5zY2hlZHVsZSkgfSwgZGF5KTtcblxuICAgICAgICAgICAgICAgIGlmIChzY2hlZHVsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0ID09IG51bGwpIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGFza3MucHVzaChTZXJpZXNFbGVtZW50LmZ1bGxEYXkoZGF5LCBsYXN0LnRhcmdldFRlbXBlcmF0dXJlKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBvbmUgc2V0cG9pbnRcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjaGVkdWxlcy5sZW5ndGggPT09IDEgJiYgbGFzdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tzLnB1c2goU2VyaWVzRWxlbWVudC5mdWxsRGF5KGRheSwgc2NoZWR1bGVzWzBdLnRhcmdldFRlbXBlcmF0dXJlKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBsZXQgcHJldmlvdXM6IEluZGV4ZWRTZXRQb2ludCB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgc2NoZWR1bGVzLmZvckVhY2goKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tzLnB1c2goU2VyaWVzRWxlbWVudC5maXJzdEhhbGYobGFzdCBhcyBJbmRleGVkU2V0UG9pbnQsIGN1cnJlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tzLnB1c2gobmV3IFNlcmllc0VsZW1lbnQocHJldmlvdXMsIGN1cnJlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91cyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVudGlsIGVvZFxuICAgICAgICAgICAgICAgICAgICB0YXNrcy5wdXNoKG5ldyBTZXJpZXNFbGVtZW50KHByZXZpb3VzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNoYXJ0LmRhdGEodGFza3MpO1xuICAgICAgICB9XG4gICAgfSwgW3BsYW4sIGRpbWVuc2lvbnNdKTtcblxuICAgIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIChzZXRSZWYgYXMgYW55KShyZWYuY3VycmVudCk7XG4gICAgfSwgW3JlZl0pO1xuXG4gICAgcmV0dXJuICg8ZGl2IHN0eWxlPXt7IGhlaWdodDogaGVpZ2h0IHx8IDMwMCB9fSBjbGFzc05hbWU9e2NsYXNzZXMuY2hhcnR9IHJlZj17cmVmfSAvPik7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoU3R5bGVzKHN0eWxlcykoVGVtcGVyYXR1cmVDaGFydCk7XG4iLCIvKipcbiAqIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9kazg5OTYvR2FudHQtQ2hhcnRcbiAqL1xuXG5pbXBvcnQgKiBhcyBkMyBmcm9tIFwiZDNcIjtcbmltcG9ydCB7IEF4aXMsIFNjYWxlQmFuZCwgU2NhbGVUaW1lIH0gZnJvbSBcImQzXCI7XG5pbXBvcnQgdHJhbnNsYXRlIGZyb20gXCIuLi8uLi9pMThuL1RyYW5zbGF0aW9uXCI7XG5pbXBvcnQgeyBTZXJpZXNFbGVtZW50IH0gZnJvbSBcIi4vU2VyaWVzRWxlbWVudFwiO1xuXG5leHBvcnQgY29uc3QgTUlOX0RBVEUgPSBuZXcgRGF0ZSgxOTc5LCAxLCAyOSwgMCwgMCwgMCwgMCk7XG5leHBvcnQgY29uc3QgTUFYX0RBVEUgPSBuZXcgRGF0ZSgxOTc5LCAxLCAzMCwgMCwgMCwgMCwgMCk7XG5cbmV4cG9ydCBjbGFzcyBTVkdHZW5lcmF0b3Ige1xuICAgIHB1YmxpYyB0aWNrRm9ybWF0OiBzdHJpbmcgPSBcIiVIOiVNXCI7XG4gICAgcHVibGljIG1hcmdpbiA9IHtcbiAgICAgICAgdG9wOiAwLFxuICAgICAgICByaWdodDogMTYsXG4gICAgICAgIGJvdHRvbTogMTYsXG4gICAgICAgIGxlZnQ6IDI4LFxuICAgIH07XG5cbiAgICBwcml2YXRlIG1pblRpbWU6IERhdGU7XG4gICAgcHJpdmF0ZSBtYXhUaW1lOiBEYXRlO1xuXG4gICAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlcjtcbiAgICBwcml2YXRlIHdpZHRoOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHhTY2FsZSE6IFNjYWxlVGltZTxudW1iZXIsIG51bWJlcj47XG4gICAgcHJpdmF0ZSB5U2NhbGUhOiBTY2FsZUJhbmQ8c3RyaW5nPjtcblxuICAgIHByaXZhdGUgeEF4aXMhOiBBeGlzPGFueT47XG4gICAgcHJpdmF0ZSB5QXhpcyE6IEF4aXM8c3RyaW5nPjtcblxuICAgIHByaXZhdGUgc2VyaWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBwcml2YXRlIHNob3dMZWdlbmQgPSB0cnVlLFxuICAgICAgICB3aWR0aD86IG51bWJlciwgaGVpZ2h0PzogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMubWluVGltZSA9IE1JTl9EQVRFO1xuICAgICAgICB0aGlzLm1heFRpbWUgPSBNQVhfREFURTtcblxuICAgICAgICBpZiAoIXRoaXMuc2hvd0xlZ2VuZCkge1xuICAgICAgICAgICAgdGhpcy5tYXJnaW4gPSB7XG4gICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogMCxcbiAgICAgICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gKGhlaWdodCA/IGhlaWdodCA6IHJvb3RFbGVtZW50LmNsaWVudEhlaWdodCkgLSB0aGlzLm1hcmdpbi50b3AgLSB0aGlzLm1hcmdpbi5ib3R0b207XG4gICAgICAgIHRoaXMud2lkdGggPSAod2lkdGggPyB3aWR0aCA6IHJvb3RFbGVtZW50LmNsaWVudFdpZHRoKSAtIDMyIC0gdGhpcy5tYXJnaW4ucmlnaHQgLSB0aGlzLm1hcmdpbi5sZWZ0O1xuXG4gICAgICAgIHRoaXMuc2VyaWVzID0gW1xuICAgICAgICAgICAgdHJhbnNsYXRlKFwic2NoZWR1bGUuTW9uZGF5XCIpLFxuICAgICAgICAgICAgdHJhbnNsYXRlKFwic2NoZWR1bGUuVHVlc2RheVwiKSxcbiAgICAgICAgICAgIHRyYW5zbGF0ZShcInNjaGVkdWxlLldlZG5lc2RheVwiKSxcbiAgICAgICAgICAgIHRyYW5zbGF0ZShcInNjaGVkdWxlLlRodXJzZGF5XCIpLFxuICAgICAgICAgICAgdHJhbnNsYXRlKFwic2NoZWR1bGUuRnJpZGF5XCIpLFxuICAgICAgICAgICAgdHJhbnNsYXRlKFwic2NoZWR1bGUuU2F0dXJkYXlcIiksXG4gICAgICAgICAgICB0cmFuc2xhdGUoXCJzY2hlZHVsZS5TdW5kYXlcIiksXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5pbml0QXhpcygpO1xuICAgICAgICB0aGlzLmNyZWF0ZUNoYXJ0KHRydWUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkYXRhKGRhdGE6IFNlcmllc0VsZW1lbnRbXSkge1xuICAgICAgICBjb25zdCBzdmcgPSB0aGlzLmNyZWF0ZUNoYXJ0KGZhbHNlKTtcbiAgICAgICAgY29uc3QgY2hhcnQgPSBzdmcuc2VsZWN0KFwiLmNoYXJ0XCIpO1xuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgYWxsRGF0YSA9IGNoYXJ0LnNlbGVjdEFsbChcImdcIikuZGF0YTxTZXJpZXNFbGVtZW50PihcbiAgICAgICAgICAgIGRhdGEsIChkOiBTZXJpZXNFbGVtZW50KSA9PiBkLnN0YXJ0ICsgZC50YXNrTmFtZSArIGQuZW5kKTtcblxuICAgICAgICBjb25zdCB0aW1lc2xvdCA9IGFsbERhdGEuZW50ZXIoKVxuICAgICAgICAgICAgLmluc2VydChcImdcIilcbiAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCAoZDogU2VyaWVzRWxlbWVudCkgPT4gZC5jb2xvcilcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIChkOiBTZXJpZXNFbGVtZW50KSA9PiBcInRyYW5zbGF0ZShcIiArIHRoaXMueFNjYWxlKGQuc3RhcnQpICsgXCIsXCIgKyB0aGlzLnlTY2FsZShkLnRhc2tOYW1lKSArIFwiKVwiKTtcblxuICAgICAgICB0aW1lc2xvdC5pbnNlcnQoXCJyZWN0XCIpXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLnlTY2FsZS5iYW5kd2lkdGgpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIChkOiBTZXJpZXNFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDEsICgodGhpcy54U2NhbGUoZC5lbmQpIHx8IDApIC0gKHRoaXMueFNjYWxlKGQuc3RhcnQpIHx8IDApKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy5zaG93TGVnZW5kKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gdGltZXNsb3QuaW5zZXJ0KFwidGV4dFwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJzdGFydFwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCA2KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCAyMClcbiAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIChkOiBTZXJpZXNFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCgxLCAoKHRoaXMueFNjYWxlKGQuZW5kKSB8fCAwKSAtICh0aGlzLnhTY2FsZShkLnN0YXJ0KSB8fCAwKSAtIDYpKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50ZXh0KChkOiBTZXJpZXNFbGVtZW50KSA9PiB0aGlzLmZpeGVkRGlnaXRzKGQudGVtcGVyYXR1cmUsIDEpKTtcblxuICAgICAgICAgICAgdGhpcy5kb3RtZSh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBhbGxEYXRhLmV4aXQoKS5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRBeGlzKCkge1xuICAgICAgICB0aGlzLnhTY2FsZSA9IGQzLnNjYWxlVGltZSgpXG4gICAgICAgICAgICAuZG9tYWluKFt0aGlzLm1pblRpbWUsIHRoaXMubWF4VGltZV0pXG4gICAgICAgICAgICAucmFuZ2UoWzAsIHRoaXMud2lkdGhdKVxuICAgICAgICAgICAgLmNsYW1wKHRydWUpOyAvLyBjdXQgb2ZmIGxvbmdlciBlbnRyaWVzIChzaG91bGQgbm90IGhhcHBlbilcblxuICAgICAgICB0aGlzLnlTY2FsZSA9IGQzLnNjYWxlQmFuZCgpXG4gICAgICAgICAgICAuZG9tYWluKHRoaXMuc2VyaWVzKVxuICAgICAgICAgICAgLnJhbmdlUm91bmQoWzAsIHRoaXMuaGVpZ2h0IC0gdGhpcy5tYXJnaW4udG9wIC0gdGhpcy5tYXJnaW4uYm90dG9tXSlcbiAgICAgICAgICAgIC5wYWRkaW5nKHRoaXMuc2hvd0xlZ2VuZCA/IC4xIDogMCk7IC8vIHNvbWUgc3BhY2UgYmV0d2VlblxuXG4gICAgICAgIHRoaXMueEF4aXMgPSBkMy5heGlzQm90dG9tKHRoaXMueFNjYWxlKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgLnRpY2tGb3JtYXQoZDMudGltZUZvcm1hdCh0aGlzLnRpY2tGb3JtYXQpKVxuICAgICAgICAgICAgLnRpY2tTaXplKHRoaXMuc2hvd0xlZ2VuZCA/IDggOiAwKVxuICAgICAgICAgICAgLnRpY2tQYWRkaW5nKHRoaXMuc2hvd0xlZ2VuZCA/IDggOiAwKTtcblxuICAgICAgICB0aGlzLnlBeGlzID0gZDNcbiAgICAgICAgICAgIC5heGlzTGVmdCh0aGlzLnlTY2FsZSlcbiAgICAgICAgICAgIC50aWNrUGFkZGluZyh0aGlzLnNob3dMZWdlbmQgPyA4IDogMClcbiAgICAgICAgICAgIC50aWNrU2l6ZSgwKTsgLy8gbm8gdGlja3NcbiAgICB9XG5cbiAgICBwcml2YXRlIGRvdG1lKHRleHROb2RlOiBhbnkpIHtcbiAgICAgICAgdGV4dE5vZGUuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkMy5zZWxlY3QodGhpcyk7XG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IHBhcnNlSW50KHRleHQuYXR0cihcIndpZHRoXCIpLCAxMCk7XG5cbiAgICAgICAgICAgIGlmICh0ZXh0LnRleHQoKS5sZW5ndGggKiAoMjcgLyA0IC8qIHBlciBjaGFyYWN0ZXIgKi8pID4gd2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0ZXh0LnRleHQoXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZml4ZWREaWdpdHModmFsdWU6IG51bWJlciwgZGlnaXRzOiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJvdW5kKHZhbHVlICogTWF0aC5wb3coMTAsIGRpZ2l0cykpIC8gTWF0aC5wb3coMTAsIGRpZ2l0cykpLnRvRml4ZWQoZGlnaXRzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNoYXJ0KGluaXQ6IGJvb2xlYW4pIHtcbiAgICAgICAgbGV0IHN2ZyA9IGQzLnNlbGVjdCh0aGlzLnJvb3RFbGVtZW50KS5zZWxlY3QoXCJzdmdcIik7XG4gICAgICAgIGlmIChpbml0KSB7IHN2Zy5yZW1vdmUoKTsgfVxuXG4gICAgICAgIGlmIChzdmcuZW1wdHkoKSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgc3ZnID0gZDMuc2VsZWN0KHRoaXMucm9vdEVsZW1lbnQpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInN2Z1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgdGhpcy53aWR0aCArIHRoaXMubWFyZ2luLmxlZnQgKyB0aGlzLm1hcmdpbi5yaWdodClcbiAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLmhlaWdodCArIHRoaXMubWFyZ2luLnRvcCArIHRoaXMubWFyZ2luLmJvdHRvbSk7XG5cbiAgICAgICAgICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImNoYXJ0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB0aGlzLndpZHRoICsgdGhpcy5tYXJnaW4ubGVmdCArIHRoaXMubWFyZ2luLnJpZ2h0KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHRoaXMuaGVpZ2h0ICsgdGhpcy5tYXJnaW4udG9wICsgdGhpcy5tYXJnaW4uYm90dG9tKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgdGhpcy5tYXJnaW4ubGVmdCArIFwiLCBcIiArIHRoaXMubWFyZ2luLnRvcCArIFwiKVwiKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0xlZ2VuZCkge1xuICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ4IGF4aXNcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzLm1hcmdpbi5sZWZ0ICsgXCIsIFwiICsgKHRoaXMuaGVpZ2h0IC0gdGhpcy5tYXJnaW4udG9wIC0gdGhpcy5tYXJnaW4uYm90dG9tKSArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aGlzLnhBeGlzKTtcblxuICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ5IGF4aXNcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyB0aGlzLm1hcmdpbi5sZWZ0ICsgXCIsIDApXCIpXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHRoaXMueUF4aXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN2ZztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBEYXkgfSBmcm9tIFwiLi4vLi4vLi4vYXBwL21vZGVsXCI7XG5pbXBvcnQgdHJhbnNsYXRlIGZyb20gXCIuLi8uLi9pMThuL1RyYW5zbGF0aW9uXCI7XG5pbXBvcnQgeyBJbmRleGVkU2V0UG9pbnQgfSBmcm9tIFwiLi4vLi4vc3RhdGUvUGxhblJlZHVjZXJcIjtcbmltcG9ydCB7IHRlbXBlcmF0dXJlVG9Db2xvciB9IGZyb20gXCIuLi90ZW1wZXJhdHVyZVRvQ29sb3JcIjtcbmltcG9ydCB7IE1JTl9EQVRFIH0gZnJvbSBcIi4vU1ZHR2VuZXJhdG9yXCI7XG5cbmNvbnN0IHRyYW5zbGF0ZURheSA9IChkYXk6IERheSkgPT4ge1xuICAgIHN3aXRjaCAoZGF5KSB7XG4gICAgICAgIGNhc2UgRGF5LlN1bmRheTogcmV0dXJuIHRyYW5zbGF0ZShcInNjaGVkdWxlLlN1bmRheVwiKTtcbiAgICAgICAgY2FzZSBEYXkuTW9uZGF5OiByZXR1cm4gdHJhbnNsYXRlKFwic2NoZWR1bGUuTW9uZGF5XCIpO1xuICAgICAgICBjYXNlIERheS5UdWVzZGF5OiByZXR1cm4gdHJhbnNsYXRlKFwic2NoZWR1bGUuVHVlc2RheVwiKTtcbiAgICAgICAgY2FzZSBEYXkuV2VkbmVzZGF5OiByZXR1cm4gdHJhbnNsYXRlKFwic2NoZWR1bGUuV2VkbmVzZGF5XCIpO1xuICAgICAgICBjYXNlIERheS5UaHVyc2RheTogcmV0dXJuIHRyYW5zbGF0ZShcInNjaGVkdWxlLlRodXJzZGF5XCIpO1xuICAgICAgICBjYXNlIERheS5GcmlkYXk6IHJldHVybiB0cmFuc2xhdGUoXCJzY2hlZHVsZS5GcmlkYXlcIik7XG4gICAgICAgIGNhc2UgRGF5LlNhdHVyZGF5OiByZXR1cm4gdHJhbnNsYXRlKFwic2NoZWR1bGUuU2F0dXJkYXlcIik7XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiBcIlhYXCI7XG4gICAgfVxufTtcblxuZXhwb3J0IGNsYXNzIFNlcmllc0VsZW1lbnQge1xuICAgIHB1YmxpYyBzdGF0aWMgZnVsbERheShkYXk6IERheSwgdGVtcGVyYXR1cmU6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gbmV3IFNlcmllc0VsZW1lbnQoe1xuICAgICAgICAgICAgaG91cjogMCxcbiAgICAgICAgICAgIG1pbnV0ZTogMCxcbiAgICAgICAgICAgIHRhcmdldFRlbXBlcmF0dXJlOiB0ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgIGluZGV4OiAtMSxcbiAgICAgICAgICAgIGRheSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBmaXJzdEhhbGYoZnJvbTogSW5kZXhlZFNldFBvaW50LCB0bzogSW5kZXhlZFNldFBvaW50KSB7XG4gICAgICAgIHJldHVybiBuZXcgU2VyaWVzRWxlbWVudCh7XG4gICAgICAgICAgICBob3VyOiAwLFxuICAgICAgICAgICAgbWludXRlOiAwLFxuICAgICAgICAgICAgdGFyZ2V0VGVtcGVyYXR1cmU6IGZyb20gPyBmcm9tLnRhcmdldFRlbXBlcmF0dXJlIDogdG8udGFyZ2V0VGVtcGVyYXR1cmUsXG4gICAgICAgICAgICBpbmRleDogLTEsXG4gICAgICAgICAgICBkYXk6IHRvLmRheSxcbiAgICAgICAgfSwgdG8pO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWFkb25seSBzdGFydCA9IG5ldyBEYXRlKE1JTl9EQVRFKTtcbiAgICBwdWJsaWMgcmVhZG9ubHkgZW5kID0gbmV3IERhdGUoTUlOX0RBVEUpO1xuXG4gICAgcHVibGljIHJlYWRvbmx5IHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgcHVibGljIHJlYWRvbmx5IHRhc2tOYW1lOiBzdHJpbmc7XG5cbiAgICBwdWJsaWMgcmVhZG9ubHkgY29sb3I6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGZyb20/OiBJbmRleGVkU2V0UG9pbnQsIHRvPzogSW5kZXhlZFNldFBvaW50KSB7XG4gICAgICAgIHRoaXMudGVtcGVyYXR1cmUgPSBmcm9tXG4gICAgICAgICAgICA/IGZyb20udGFyZ2V0VGVtcGVyYXR1cmVcbiAgICAgICAgICAgIDogdG8gPyB0by50YXJnZXRUZW1wZXJhdHVyZSA6IDA7XG5cbiAgICAgICAgdGhpcy5zdGFydC5zZXRIb3Vycyhmcm9tID8gZnJvbS5ob3VyIDogMCwgZnJvbSA/IGZyb20ubWludXRlIDogMCk7XG4gICAgICAgIHRoaXMuZW5kLnNldEhvdXJzKHRvID8gdG8uaG91ciA6IDI0LCB0byA/IHRvLm1pbnV0ZSA6IDApO1xuXG4gICAgICAgIHRoaXMudGFza05hbWUgPSB0cmFuc2xhdGVEYXkoZnJvbVxuICAgICAgICAgICAgICAgID8gZnJvbS5kYXlcbiAgICAgICAgICAgICAgICA6IHRvID8gdG8uZGF5IDogMCk7XG5cbiAgICAgICAgdGhpcy5jb2xvciA9IHRlbXBlcmF0dXJlVG9Db2xvcih0aGlzLnRlbXBlcmF0dXJlKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gXCIuL0NvbXBvbmVudFwiO1xuZXhwb3J0IGRlZmF1bHQgQ29tcG9uZW50O1xuXG5leHBvcnQgeyBjYWxjdWxhdGVEYXkgfSBmcm9tIFwiLi4vLi4vc3RhdGUvY2FsY3VsYXRlRGF5XCI7XG4iLCJpbXBvcnQgYW1iZXIgZnJvbSBcIkBtYXRlcmlhbC11aS9jb3JlL2NvbG9ycy9hbWJlclwiO1xuaW1wb3J0IGJsdWUgZnJvbSBcIkBtYXRlcmlhbC11aS9jb3JlL2NvbG9ycy9ibHVlXCI7XG5pbXBvcnQgZGVlcE9yYW5nZSBmcm9tIFwiQG1hdGVyaWFsLXVpL2NvcmUvY29sb3JzL2RlZXBPcmFuZ2VcIjtcbmltcG9ydCBncmVlbiBmcm9tIFwiQG1hdGVyaWFsLXVpL2NvcmUvY29sb3JzL2dyZWVuXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBzbG90VGVtcGVyYXR1cmUodmFsOiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcbiAgICAvLyAgICAgICAgKGItYSkoeCAtIG1pbilcbiAgICAvLyBmKHgpID0gLS0tLS0tLS0tLS0tLS0gKyAgYVxuICAgIC8vICAgICAgICBtYXggLSBtaW5cbiAgICAvL1xuICAgIHJldHVybiBNYXRoLmZsb29yKFxuICAgICAgICAoKChiIC0gYSkgKiAodmFsIC0gbWluKSkgL1xuICAgICAgICAobWF4IC0gbWluKSlcbiAgICAgICAgKyBhLFxuICAgICk7XG59XG5cbmV4cG9ydCBjb25zdCB0ZW1wZXJhdHVyZVRvQ29sb3IgPSAobjogbnVtYmVyKSA9PiB7XG4gICAgLy8gcHJvamVjdCAxNiAuLi4gMjQgdG8gMjAwIC4uLiA5MDBcbiAgICBjb25zdCBzaGFkZSA9IE1hdGgucm91bmQoc2xvdFRlbXBlcmF0dXJlKFxuICAgICAgICBNYXRoLm1pbihNYXRoLm1heCgxNiwgbiksIDI0KSxcbiAgICAgICAgMTYsIDI0LFxuICAgICAgICAxLCA4KSAqIDEwMCArIDEwMCk7XG5cbiAgICBpZiAobiA8PSAxNikge1xuICAgICAgICByZXR1cm4gYmx1ZVtzaGFkZV07XG4gICAgfVxuXG4gICAgaWYgKG4gPD0gMTguNSkge1xuICAgICAgICByZXR1cm4gZ3JlZW5bc2hhZGVdO1xuICAgIH1cblxuICAgIGlmIChuIDw9IDIwLjUpIHtcbiAgICAgICAgcmV0dXJuIGFtYmVyW3NoYWRlXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVlcE9yYW5nZVtzaGFkZV07XG59O1xuIl0sIm5hbWVzIjpbInRoZW1lIiwiY2hhcnQiLCJwYWRkaW5nIiwic3BhY2luZyIsIndpZHRoIiwiZmlsbCIsInBhbGV0dGUiLCJ0ZXh0IiwicHJpbWFyeSIsImZvbnRTaXplIiwicHJvcHMiLCJjbGFzc2VzIiwicGxhbiIsImhlaWdodCIsImxlZ2VuZCIsInJlZiIsInNldFJlZiIsImRpbWVuc2lvbnMiLCJzZXREaW1lbnNpb25zIiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ1cGRhdGVEaW1lbnNpb25zIiwiaW5uZXIiLCJmdW5jIiwic2F2ZWRSZWYiLCJkZWJvdW5jZSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidXNlRGltZW5zaW9ucyIsImN1cnJlbnQiLCJTVkdHZW5lcmF0b3IiLCJ0YXNrcyIsIkRheSIsImZvckVhY2giLCJkYXkiLCJzY2hlZHVsZXMiLCJsYXN0IiwiY2FsY3VsYXRlRGF5Iiwic2NoZWR1bGUiLCJzb3J0U2NoZWR1bGVzIiwibGVuZ3RoIiwicHVzaCIsIlNlcmllc0VsZW1lbnQiLCJ0YXJnZXRUZW1wZXJhdHVyZSIsInByZXZpb3VzIiwiZGF0YSIsInN0eWxlIiwiY2xhc3NOYW1lIiwiTUlOX0RBVEUiLCJEYXRlIiwiTUFYX0RBVEUiLCJjb25zdHJ1Y3RvciIsInJvb3RFbGVtZW50Iiwic2hvd0xlZ2VuZCIsInRpY2tGb3JtYXQiLCJtYXJnaW4iLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJzZXJpZXMiLCJ0aGlzIiwibWluVGltZSIsIm1heFRpbWUiLCJpbml0QXhpcyIsImNyZWF0ZUNoYXJ0IiwiYWxsRGF0YSIsInNlbGVjdCIsInNlbGVjdEFsbCIsImQiLCJzdGFydCIsInRhc2tOYW1lIiwiZW5kIiwidGltZXNsb3QiLCJlbnRlciIsImluc2VydCIsImF0dHIiLCJjb2xvciIsInhTY2FsZSIsInlTY2FsZSIsImJhbmR3aWR0aCIsIk1hdGgiLCJtYXgiLCJmaXhlZERpZ2l0cyIsInRlbXBlcmF0dXJlIiwiZG90bWUiLCJleGl0IiwicmVtb3ZlIiwiZG9tYWluIiwicmFuZ2UiLCJjbGFtcCIsInJhbmdlUm91bmQiLCJ4QXhpcyIsInRpY2tTaXplIiwidGlja1BhZGRpbmciLCJ5QXhpcyIsInRleHROb2RlIiwiZWFjaCIsInBhcnNlSW50IiwidmFsdWUiLCJkaWdpdHMiLCJyb3VuZCIsInBvdyIsInRvRml4ZWQiLCJpbml0Iiwic3ZnIiwiZW1wdHkiLCJhcHBlbmQiLCJjYWxsIiwic3RhdGljIiwiaG91ciIsIm1pbnV0ZSIsImluZGV4IiwiZnJvbSIsInRvIiwic2V0SG91cnMiLCJ0cmFuc2xhdGVEYXkiLCJ0ZW1wZXJhdHVyZVRvQ29sb3IiLCJzbG90VGVtcGVyYXR1cmUiLCJ2YWwiLCJtaW4iLCJhIiwiYiIsImZsb29yIiwibiIsInNoYWRlIl0sInNvdXJjZVJvb3QiOiIifQ==